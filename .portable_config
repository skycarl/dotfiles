
# Detect OS
if [[ "$(uname)" == "Darwin" ]]; then
    # macOS
    bindkey -e
    bindkey '^[b' backward-word
    bindkey '^[f' forward-word
elif [[ -f /etc/system-release && $(grep -i "amazon linux" /etc/system-release) ]]; then
    # Amazon Linux 2
    bindkey -e
    bindkey '^[[1;5D' backward-word
    bindkey '^[[1;5C' forward-word
elif [[ -f /etc/os-release && $(grep -qi "ubuntu" /etc/os-release) ]]; then
    # Ubuntu
    bindkey -e
    bindkey '^[[1;5D' backward-word
    bindkey '^[[1;5C' forward-word
elif [[ -f /etc/os-release && $(grep -qi "red hat" /etc/os-release) ]]; then
    # RHEL
    bindkey -e
    bindkey '^[[1;5D' backward-word
    bindkey '^[[1;5C' forward-word
else
    # Others
    bindkey -e
    bindkey '^[b' backward-word
    bindkey '^[f' forward-word
fi

# Enable autocompletion
zstyle ':completion:*' matcher-list 'm:{a-zA-Z}={A-Za-z}'
if [[ -n "$ZSH_VERSION" ]]; then
    autoload -Uz compinit && compinit
elif [[ -n "$BASH_VERSION" ]]; then
    autoload -U compinit && compinit
fi

# Incremental history search with up/down arrows
bindkey '^[[A' history-search-backward
bindkey '^[[B' history-search-forward

export GIT_PAGER=$(command -v bat >/dev/null 2>&1 && echo "bat" || echo "cat")

alias ll='ls -lah'

# Git aliases
alias gps="git push"
alias gpl="git pull"
alias gcm="git commit -m"
alias gs="git status"
alias ga="git add"
alias gitupdate='find . -name .git -print -execdir git pull \;'

# Docker aliases
alias dps="docker ps"
alias dcu="docker compose up"
alias dcd="docker compose down"
alias dcb="docker compose build"

# General aliases
alias grh="history|grep"
alias sha='shasum -a 256 '
alias ping='ping -c 5'
alias ipe='curl ipinfo.io/ip'
alias ipi='ipconfig getifaddr en0'
alias c='clear'
alias sz='source ~/.zshrc'
alias sha='shasum -a 256 '
alias untar='tar -zxvf '
alias tar='tar -czvf '

# Save more history, ignore duplicates and lines starting with space
HISTFILE=~/.zsh_history
HISTSIZE=10000
SAVEHIST=10000
setopt HIST_IGNORE_DUPS
setopt HIST_IGNORE_ALL_DUPS
setopt HIST_IGNORE_SPACE
setopt HIST_VERIFY

setopt EXTENDED_GLOB
setopt AUTO_CD
setopt CORRECT